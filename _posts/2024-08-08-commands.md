---
title: Commands (CMD/PS)
---

Show General System Information (OS, Boot-time, Specs, NIC, Hyper-V Req)
* systeminfo

Hostname (shows hostname of computer) and Serial Number (shows S/N of computer)
* hostname
* wmic bios get serialnumber

Ping
  * Continuous Ping
    * ping –t X.X.X.X
  * Pull DNS info from Ping (alternatively, use nslookup)
    * ping –a X.X.X.X
  * Ping a certain amount of packets (Ex 60 packets [good for flapping alerts])
    * ping X.X.X.X –n 60

Traceroute
  * Normal trace
    * tracert X.X.X.X
  * If unable to resolve hostname:
    * tracert X.X.X.X -d

Shows network drives connected to user (Can't use in Backstage [Have to be connected with user])
* net use

GPO
* Shows all Group Policies for computer/user
  * gpresult /r
* Update GPO
  * gpupdate /force

Computer running slow - SFC/DISM
* (Note: To save time [and patience], use this version of these commands)
  * [CMD] sfc /scannow & sfc /scannow & DISM /Online /Cleanup-Image /RestoreHealth & sfc /scannow
  * [PS] sfc /scannow; sfc /scannow; DISM /Online /Cleanup-Image /RestoreHealth; sfc /scannow
* sfc /scannow (may need to run this multiple times first before DISM)
* DISM /Online /Cleanup-Image /CheckHealth
* DISM /Online /Cleanup-Image /ScanHealth
* DISM /Online /Cleanup-Image /RestoreHealth
* Reboot

DISM to free-up space in WinSxS
* DISM /online /Cleanup-Image /StartComponentCleanup
* Note: The above command does not seem to work in Backstage (may be able to test with user-specific session)

IPConfig
* Wipes DNS Cache in Windows
  * ipconfig /flushdns
* Renews IP Address (Will boot you off if remoted in):
  * ipconfig /release & ipconfig /renew
* Shows IPv4, IPv6, DNS, etc.
  * ipconfig /all

Find/Logoff User
* query user
* logoff IDOFUSER

Reset Password
* query user
* net user 'USER' 'PASS'

Check for Email Domain on Server (PS)
* Get-Recipient emailaddress@company.com

Backstage Printers (PS)
* Get-Printer | Format-Table
  * If you only need the Name/Driver Name: Get-Printer | Format-Table Name, DriverName
* Remove-Printer -Name "Name of Printer"
* Get-PrinterDriver
* Remove-PrinterDriver -Name "Name of Driver"

Check Domain Connection (PS)
* Test-ComputerSecureChannel -Verbose

Re-Add Computer to Domain (PS)
* Reset-ComputerMachinePassword -Server {DomainController} -Credential {DomainAdmin}
  * EXAMPLE: Reset-ComputerMachinePassword -Server lon-dc01 -Credential corp\dsmith

Check Route Table
* netstat -r
* Cisco/Fortinet?: show ip route

Clear ARP Table
* arp -d *
  * Can be used to solve connectivity issues internally

Check Current Running Connections (at current time [will not update unless ran again])
* netstat -ano | findstr "443" (Windows)
* netstat -ano | grep "443" (Linux)
* TCPLogView may be a useful tool for logging data over time

Find & Cycle Network Adapter
* (PS)
  * Get-NetAdapter | format-table
  * Disable-NetAdapter -Name "<interface>" -Confirm:$false
  * Enable-NetAdapter -Name "<interface>" -Confirm:$false
  * Restart-NetAdapter
* (CMD)
  * netsh interface show interface
  * netsh interface set interface "<interface>" disable
  * netsh interface set interface "<interface>" enable

Find TXT records of domain (example is DMARC)
* nslookup -type=txt _dmarc.domain.com
  * This should work for other text records too if you know which one you're looking for

Get Current CPU Percentage (PS)
* Get-CimInstance -ClassName win32_processor | Measure-Object -Property LoadPercentage –Average

Sync Changes to Azure
* Start ADSyncSyncCycle
  * This changes for all changed
* Start ADSyncSyncCycle –PolicyType delta
  * This changes for a specific policy

Find FQDN (Fully Qualified Domain Name) of Host (PS)
* [System.Net.Dns]::GetHostByName($env:COMPUTERNAME).HostName

Find File (PS)
* gci -r -fi '*.<EXTENSION>'

Get and Restart Service (PS)
* Get-Service -Name <Name> (leave blank for all Services)
* Restart-Service <Name>
* Ex: Restart Print Spooler
  * Restart-Service Spooler

Test Domain Trust Broker (PS)
* Test-ComputerSecureChannel -Verbose
* If above is True, everything should be fine | If False, run the below command
  * Test-ComputerSecureChannel -Repair -Credential (Get-Credential)

Resync Time
* net stop w32time && w32tm /unregister && w32tm /register && net start w32time && w32tm /resync && tzutil /s "Eastern Standard Time"
* For a list of Time Zones, run: tzutil /l

Open Network Routing Tables
* route print

Remove folder/files (PS)
* Remove-Item FOLDERNAME
* Alias if used to Linux/BASH for deleting folder with items still inside: "rm -rfo"
  * -rfo = Recursively run through folder (childed contents inside folder) and Force this command to run under -o = Path to file/folder

See storage information of a Drive (PS)
* Get-Volume C
  * Can change "C" for other drive letters
